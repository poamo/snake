<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>차이 게임 (한국어/영어)</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    #language-selector { margin-bottom: 20px; }
    button { padding: 8px 16px; margin-right: 8px; }
    #game-area { max-width: 600px; margin: 0 auto; }
    .card { display: inline-block; width: 60px; height: 80px; margin: 10px; border: 1px solid #ccc; text-align: center; line-height: 80px; font-size: 24px; cursor: pointer; background: #f9f9f9; }
    .selected { background: #cfc; }
    #hint { color: #666; font-style: italic; margin-top: 20px; }
    #result { margin-top: 20px; font-weight: bold; }
    #player-names { margin-bottom: 10px; }
    .player-score { font-weight: bold; margin-right: 15px; }
    .pass-btn { margin-left: 10px; }
    #start-btn { margin-top: 10px; }
    #game-size { margin-bottom: 10px; }
  </style>
</head>
<body>
  <div id="language-selector">
    <button id="btn-en">English</button>
    <button id="btn-ko" style="background: #cfc;">한국어</button>
  </div>
  <div id="game-area">
    <p id="challenge-text"></p>
    <p id="first-player-text"></p>
    <p id="second-player-text"></p>
    <p id="correct-equation-text"></p>
    <p id="game-over-text"></p>
    <p id="enter-names-text"></p>
    <p id="select-size-text"></p>
    <div id="player-names">
      <input type="text" id="player1" placeholder="플레이어1">
      <input type="text" id="player2" placeholder="플레이어2">
      <button id="start-btn">시작</button>
    </div>
    <div id="game-size">
      <select id="size">
        <option value="7">7장</option>
        <option value="10">10장</option>
        <option value="13">13장</option>
      </select>
    </div>
    <div id="cards"></div>
    <div id="result"></div>
    <div id="scores">
      <span id="score1" class="player-score"></span>
      <span id="score2" class="player-score"></span>
      <button id="pass-btn" class="pass-btn">패스</button>
    </div>
    <p id="hint"></p>
  </div>

  <script>
    // 언어별 메시지
    const messages = {
      en: {
        challenge: "Challenge your opponent to a differences game! Players take turns.",
        firstPlayerSelect: "The first player selects a number and presses.",
        secondPlayerSelect: "The second player selects two numbers whose difference equals the first player's number and presses.",
        correctEquation: "If the equation is correct, the second player gets a point.",
        gameOver: "Game over when no cards left or both players pass consecutively. The player with the most points wins.",
        enterNames: "Enter one or two player names.",
        selectSize: "Select a game size.",
        hint: "Select two numbers so that the number on the right is correct and press.",
        pass: "Pass",
        start: "Start",
        winner: "Winner: ",
        draw: "Draw!",
        player1: "Player 1",
        player2: "Player 2",
        score: "Score: "
      },
      ko: {
        challenge: "상대방과 차이 게임에 도전하세요! 플레이어는 번갈아 가며 플레이합니다.",
        firstPlayerSelect: "첫 번째 플레이어가 숫자를 선택하고 누릅니다.",
        secondPlayerSelect: "두 번째 플레이어가 두 숫자를 선택하여 첫 번째 플레이어의 숫자 차이를 만듭니다.",
        correctEquation: "방정식이 맞으면 두 번째 플레이어가 점수를 얻습니다.",
        gameOver: "플레이어가 카드를 모두 사용했거나 두 플레이어가 연속으로 패스하면 게임이 종료됩니다. 가장 많은 점수를 얻은 플레이어가 승리합니다.",
        enterNames: "한 명 또는 두 명의 플레이어 이름을 입력하세요.",
        selectSize: "게임 크기를 선택하세요.",
        hint: "두 숫자를 선택하여 오른쪽 숫자를 맞추고 누르세요.",
        pass: "패스",
        start: "시작",
        winner: "승자: ",
        draw: "무승부!",
        player1: "플레이어1",
        player2: "플레이어2",
        score: "점수: "
      }
    };

    let currentLanguage = 'ko'; // 기본 언어: 한국어

    // 언어 변경 함수
    function changeLanguage(lang) {
      currentLanguage = lang;
      document.getElementById('challenge-text').textContent = messages[lang].challenge;
      document.getElementById('first-player-text').textContent = messages[lang].firstPlayerSelect;
      document.getElementById('second-player-text').textContent = messages[lang].secondPlayerSelect;
      document.getElementById('correct-equation-text').textContent = messages[lang].correctEquation;
      document.getElementById('game-over-text').textContent = messages[lang].gameOver;
      document.getElementById('enter-names-text').textContent = messages[lang].enterNames;
      document.getElementById('select-size-text').textContent = messages[lang].selectSize;
      document.getElementById('hint').textContent = messages[lang].hint;
      document.getElementById('pass-btn').textContent = messages[lang].pass;
      document.getElementById('start-btn').textContent = messages[lang].start;
      document.getElementById('player1').placeholder = messages[lang].player1;
      document.getElementById('player2').placeholder = messages[lang].player2;
      // 버튼 스타일 초기화
      document.getElementById('btn-en').style.background = '';
      document.getElementById('btn-ko').style.background = '';
      // 선택된 언어 버튼 강조
      if (lang === 'en') document.getElementById('btn-en').style.background = '#cfc';
      else document.getElementById('btn-ko').style.background = '#cfc';
    }

    // 버튼 이벤트
    document.getElementById('btn-en').addEventListener('click', () => changeLanguage('en'));
    document.getElementById('btn-ko').addEventListener('click', () => changeLanguage('ko'));

    // 초기 언어 설정
    changeLanguage(currentLanguage);

    // 게임 로직
    let cards = [];
    let selectedCards = [];
    let currentPlayer = 1;
    let player1Name = messages[currentLanguage].player1;
    let player2Name = messages[currentLanguage].player2;
    let player1Score = 0;
    let player2Score = 0;
    let gameStarted = false;
    let consecutivePass = 0;

    function startGame() {
      const size = parseInt(document.getElementById('size').value);
      cards = [];
      selectedCards = [];
      currentPlayer = 1;
      player1Score = 0;
      player2Score = 0;
      consecutivePass = 0;
      gameStarted = true;
      document.getElementById('result').textContent = '';
      document.getElementById('scores').style.display = 'block';
      document.getElementById('pass-btn').style.display = 'inline-block';

      player1Name = document.getElementById('player1').value || messages[currentLanguage].player1;
      player2Name = document.getElementById('player2').value || messages[currentLanguage].player2;

      // 카드 생성
      for (let i = 1; i <= 20; i++) {
        cards.push(i);
      }
      // 카드 섞기
      for (let i = cards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [cards[i], cards[j]] = [cards[j], cards[i]];
      }
      cards = cards.slice(0, size);

      renderCards();
      updateScores();
    }

    function renderCards() {
      const container = document.getElementById('cards');
      container.innerHTML = '';
      cards.forEach((num, idx) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.index = idx;
        card.textContent = num;
        card.addEventListener('click', () => selectCard(idx));
        container.appendChild(card);
      });
    }

    function selectCard(idx) {
      if (!gameStarted) return;
      const card = document.querySelector(`.card[data-index="${idx}"]`);
      if (selectedCards.includes(idx)) {
        selectedCards = selectedCards.filter(i => i !== idx);
        card.classList.remove('selected');
      } else {
        if (selectedCards.length < 2) {
          selectedCards.push(idx);
          card.classList.add('selected');
        }
      }
    }

    function play() {
      if (!gameStarted || selectedCards.length === 0) return;
      if (selectedCards.length === 1) {
        // 첫 번째 플레이어: 숫자 선택
        const num = cards[selectedCards[0]];
        document.getElementById('result').textContent = `${currentPlayer === 1 ? player1Name : player2Name}: ${num}`;
        selectedCards = [];
        renderCards();
      } else if (selectedCards.length === 2) {
        // 두 번째 플레이어: 두 숫자 선택
        const num1 = cards[selectedCards[0]];
        const num2 = cards[selectedCards[1]];
        const diff = Math.abs(num1 - num2);
        const lastNum = parseInt(document.getElementById('result').textContent.split(': ')[1]);
        if (diff === lastNum) {
          // 맞춤
          if (currentPlayer === 1) player2Score++;
          else player1Score++;
          updateScores();
          document.getElementById('result').textContent = `${currentPlayer === 1 ? player2Name : player1Name} ${messages[currentLanguage].correctEquation}`;
        } else {
          // 틀림
          document.getElementById('result').textContent = `${messages[currentLanguage].hint}`;
        }
        selectedCards = [];
        renderCards();
      }
    }

    function pass() {
      if (!gameStarted) return;
      consecutivePass++;
      if (consecutivePass >= 2) {
        endGame();
      } else {
        currentPlayer = currentPlayer === 1 ? 2 : 1;
        document.getElementById('result').textContent = `${messages[currentLanguage].pass}`;
      }
    }

    function endGame() {
      gameStarted = false;
      let winner;
      if (player1Score > player2Score) winner = player1Name;
      else if (player2Score > player1Score) winner = player2Name;
      else winner = null;
      document.getElementById('result').textContent = winner ? `${messages[currentLanguage].winner}${winner}` : messages[currentLanguage].draw;
      document.getElementById('pass-btn').style.display = 'none';
    }

    function updateScores() {
      document.getElementById('score1').textContent = `${player1Name}: ${messages[currentLanguage].score}${player1Score}`;
      document.getElementById('score2').textContent = `${player2Name}: ${messages[currentLanguage].score}${player2Score}`;
    }

    function showHint(msg) {
      document.getElementById('hint').textContent = msg;
    }

    // 이벤트 리스너
    document.getElementById('start-btn').addEventListener('click', startGame);
    document.getElementById('pass-btn').addEventListener('click', pass);
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && gameStarted) play();
    });
    // 카드 클릭 시 play() 호출을 위해, 실제 게임에서는 버튼 추가 or 더블클릭 등으로 처리 가능
    // 여기서는 Enter 키로 대체

    // 초기화
    updateScores();
  </script>
</body>
</html>
